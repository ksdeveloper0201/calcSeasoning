<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>レシピ分量計算ツール | Recipe Calculator</title>
        <!-- Tailwind CSS for styling -->
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- React & ReactDOM -->
        <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
        <!-- Babel for JSX -->
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <!-- Lucide Icons -->
        <script src="https://unpkg.com/lucide@latest"></script>
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap");
            body {
                font-family: "Inter", sans-serif;
            }
        </style>
    </head>
    <body class="bg-slate-50">
        <div id="root"></div>

        <script type="text/babel">
            const { useState, useEffect } = React;

            const App = () => {
                const [baseWeight, setBaseWeight] = useState(100);
                const [targetWeight, setTargetWeight] = useState(250);
                const [ingredients, setIngredients] = useState([
                    { id: 1, name: "醤油", amount: 1, unit: "大さじ" },
                    { id: 2, name: "みりん", amount: 1, unit: "大さじ" },
                    { id: 3, name: "砂糖", amount: 0.5, unit: "小さじ" },
                ]);

                const ratio = baseWeight > 0 ? targetWeight / baseWeight : 0;

                const addRow = () => {
                    const newId = Date.now();
                    setIngredients([
                        ...ingredients,
                        { id: newId, name: "", amount: 0, unit: "g" },
                    ]);
                };

                const removeRow = (id) => {
                    setIngredients(ingredients.filter((ing) => ing.id !== id));
                };

                const updateIngredient = (id, field, value) => {
                    setIngredients(
                        ingredients.map((ing) => {
                            if (ing.id === id) {
                                return {
                                    ...ing,
                                    [field]:
                                        field === "amount"
                                            ? parseFloat(value) || 0
                                            : value,
                                };
                            }
                            return ing;
                        }),
                    );
                };

                const formatNumber = (num) => {
                    const val = (num * ratio).toFixed(2);
                    return parseFloat(val).toString();
                };

                return (
                    <div className="min-h-screen py-8 px-4 sm:px-6">
                        <div className="max-w-2xl mx-auto">
                            <header className="mb-8 text-center">
                                <div className="flex justify-center mb-4">
                                    <div className="bg-orange-500 p-3 rounded-2xl shadow-lg shadow-orange-200 text-white">
                                        <i
                                            data-lucide="chef-hat"
                                            style={{
                                                width: "32px",
                                                height: "32px",
                                            }}
                                        ></i>
                                    </div>
                                </div>
                                <h1 className="text-3xl font-extrabold text-slate-900 tracking-tight">
                                    レシピ分量計算ツール
                                </h1>
                                <p className="text-slate-500 mt-2 text-sm">
                                    メイン食材の重さに合わせて調味料を瞬時に再計算
                                </p>
                            </header>

                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6">
                                <div className="flex items-center gap-2 mb-4 text-slate-800 font-bold text-lg border-b border-slate-50 pb-2">
                                    <i
                                        data-lucide="scale"
                                        className="text-orange-500 w-5 h-5"
                                    ></i>
                                    <h2>メイン食材の重さ設定</h2>
                                </div>

                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-4">
                                    <div className="space-y-2">
                                        <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">
                                            基準の重さ (g)
                                        </label>
                                        <input
                                            type="number"
                                            value={baseWeight}
                                            onChange={(e) =>
                                                setBaseWeight(
                                                    parseFloat(
                                                        e.target.value,
                                                    ) || 0,
                                                )
                                            }
                                            className="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none transition-all"
                                        />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-xs font-bold text-orange-600 uppercase tracking-wider">
                                            今回の重さ (g)
                                        </label>
                                        <input
                                            type="number"
                                            value={targetWeight}
                                            onChange={(e) =>
                                                setTargetWeight(
                                                    parseFloat(
                                                        e.target.value,
                                                    ) || 0,
                                                )
                                            }
                                            className="w-full px-4 py-3 bg-orange-50 border border-orange-200 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none font-bold text-orange-700 text-xl"
                                        />
                                    </div>
                                </div>

                                <div className="mt-6 flex items-center gap-2 text-sm text-slate-500 bg-slate-50 p-4 rounded-xl">
                                    <i
                                        data-lucide="info"
                                        className="w-4 h-4 text-blue-400"
                                    ></i>
                                    <span>
                                        現在は基準の{" "}
                                        <span className="font-bold text-slate-800">
                                            {ratio.toFixed(2)} 倍
                                        </span>{" "}
                                        で計算しています
                                    </span>
                                </div>
                            </div>

                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-10">
                                    <h2 className="text-lg font-bold text-slate-800">
                                        調味料リスト
                                    </h2>
                                    <button
                                        onClick={addRow}
                                        className="flex items-center gap-1 bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-md active:scale-95"
                                    >
                                        <i
                                            data-lucide="plus"
                                            className="w-4 h-4"
                                        ></i>
                                        追加
                                    </button>
                                </div>

                                <div className="overflow-x-auto">
                                    <table className="w-full">
                                        <thead>
                                            <tr className="bg-slate-50/50 text-slate-400 text-[10px] uppercase tracking-[0.1em]">
                                                <th className="px-6 py-3 text-left font-bold">
                                                    調味料名
                                                </th>
                                                <th className="px-4 py-3 text-right font-bold w-28">
                                                    基準分量
                                                </th>
                                                <th className="px-4 py-3 text-left font-bold w-24">
                                                    単位
                                                </th>
                                                <th className="px-6 py-3 text-right font-bold text-orange-600 bg-orange-50/30">
                                                    今回の分量
                                                </th>
                                                <th className="px-4 py-3 w-12 text-center"></th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-slate-100">
                                            {ingredients.map((ing) => (
                                                <tr
                                                    key={ing.id}
                                                    className="group hover:bg-slate-50 transition-colors"
                                                >
                                                    <td className="px-6 py-4">
                                                        <input
                                                            type="text"
                                                            value={ing.name}
                                                            onChange={(e) =>
                                                                updateIngredient(
                                                                    ing.id,
                                                                    "name",
                                                                    e.target
                                                                        .value,
                                                                )
                                                            }
                                                            placeholder="例: しょうゆ"
                                                            className="w-full bg-transparent border-none focus:ring-0 text-slate-700 placeholder:text-slate-300 font-medium"
                                                        />
                                                    </td>
                                                    <td className="px-4 py-4">
                                                        <input
                                                            type="number"
                                                            step="0.1"
                                                            value={ing.amount}
                                                            onChange={(e) =>
                                                                updateIngredient(
                                                                    ing.id,
                                                                    "amount",
                                                                    e.target
                                                                        .value,
                                                                )
                                                            }
                                                            className="w-full text-right bg-slate-100 rounded-lg px-2 py-1 border-none focus:ring-2 focus:ring-orange-200 outline-none font-mono"
                                                        />
                                                    </td>
                                                    <td className="px-4 py-4">
                                                        <input
                                                            type="text"
                                                            value={ing.unit}
                                                            onChange={(e) =>
                                                                updateIngredient(
                                                                    ing.id,
                                                                    "unit",
                                                                    e.target
                                                                        .value,
                                                                )
                                                            }
                                                            className="w-full bg-transparent border-none focus:ring-0 text-slate-500 text-sm"
                                                        />
                                                    </td>
                                                    <td className="px-6 py-4 text-right bg-orange-50/30">
                                                        <span className="font-bold text-orange-600 text-lg font-mono tracking-tighter">
                                                            {formatNumber(
                                                                ing.amount,
                                                            )}
                                                        </span>
                                                    </td>
                                                    <td className="px-4 py-4 text-center">
                                                        <button
                                                            onClick={() =>
                                                                removeRow(
                                                                    ing.id,
                                                                )
                                                            }
                                                            className="text-slate-300 hover:text-red-500 transition-colors p-1"
                                                        >
                                                            <i
                                                                data-lucide="trash-2"
                                                                className="w-4 h-4"
                                                            ></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <footer className="mt-12 mb-8 text-center text-slate-400 text-xs">
                                <p>© 2024 Recipe Calculator Studio</p>
                                <p className="mt-1">
                                    キッチンでの比率計算をよりスマートに
                                </p>
                            </footer>
                        </div>
                    </div>
                );
            };

            // Reactのレンダリング
            const root = ReactDOM.createRoot(document.getElementById("root"));
            root.render(<App />);

            // アイコンの初期化（少し遅延させて実行）
            setTimeout(() => {
                lucide.createIcons();
            }, 100);

            // ingredientsが変更された時にアイコンを再描画
            // 実際にはもっとスマートな方法がありますが、デプロイ用シンプル版としてここに記載
        </script>
    </body>
</html>
