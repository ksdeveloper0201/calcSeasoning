<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
        />
        <title>レシピ分量計算ツール | Recipe Calculator</title>
        <!-- Tailwind CSS for styling -->
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- React & ReactDOM -->
        <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
        <!-- Babel for JSX -->
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <!-- Lucide Icons -->
        <script src="https://unpkg.com/lucide@latest"></script>
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap");
            body {
                font-family:
                    "Inter", "Hiragino Kaku Gothic ProN", "Hiragino Sans",
                    Meiryo, sans-serif;
                -webkit-tap-highlight-color: transparent;
            }
            input[type="number"]::-webkit-inner-spin-button,
            input[type="number"]::-webkit-outer-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }
        </style>
    </head>
    <body class="bg-slate-50 text-slate-900">
        <div id="root"></div>

        <script type="text/babel">
            const { useState, useEffect } = React;

            const App = () => {
                const [baseWeight, setBaseWeight] = useState(100);
                const [targetWeight, setTargetWeight] = useState(250);
                const [ingredients, setIngredients] = useState([
                    { id: 1, name: "醤油", amount: 1, unit: "大さじ" },
                    { id: 2, name: "みりん", amount: 1, unit: "大さじ" },
                    { id: 3, name: "砂糖", amount: 0.5, unit: "小さじ" },
                ]);

                useEffect(() => {
                    lucide.createIcons();
                }, [ingredients]);

                const ratio = baseWeight > 0 ? targetWeight / baseWeight : 0;

                const addRow = () => {
                    const newId = Date.now();
                    setIngredients([
                        ...ingredients,
                        { id: newId, name: "", amount: 0, unit: "g" },
                    ]);
                };

                const removeRow = (id) => {
                    setIngredients(ingredients.filter((ing) => ing.id !== id));
                };

                const updateIngredient = (id, field, value) => {
                    setIngredients(
                        ingredients.map((ing) => {
                            if (ing.id === id) {
                                return {
                                    ...ing,
                                    [field]:
                                        field === "amount"
                                            ? parseFloat(value) || 0
                                            : value,
                                };
                            }
                            return ing;
                        }),
                    );
                };

                const formatNumber = (num) => {
                    const val = (num * ratio).toFixed(2);
                    return parseFloat(val).toString();
                };

                return (
                    <div className="min-h-screen py-6 px-3 sm:px-6">
                        <div className="max-w-2xl mx-auto">
                            <header className="mb-6 text-center">
                                <div className="flex justify-center mb-3">
                                    <div className="bg-orange-500 p-2.5 rounded-2xl shadow-lg shadow-orange-200 text-white">
                                        <i
                                            data-lucide="chef-hat"
                                            className="w-7 h-7"
                                        ></i>
                                    </div>
                                </div>
                                <h1 className="text-2xl sm:text-3xl font-extrabold text-slate-900 tracking-tight">
                                    レシピ分量計算
                                </h1>
                                <p className="text-slate-500 mt-1 text-xs sm:text-sm">
                                    重さに合わせて調味料を瞬時に再計算
                                </p>
                            </header>

                            {/* Weight Config Card */}
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-5 mb-5">
                                <div className="flex items-center gap-2 mb-4 text-slate-800 font-bold border-b border-slate-50 pb-2">
                                    <i
                                        data-lucide="scale"
                                        className="text-orange-500 w-5 h-5"
                                    ></i>
                                    <h2>メイン食材の重さ</h2>
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                    <div className="space-y-1.5">
                                        <label className="text-[10px] font-bold text-slate-400 uppercase tracking-wider">
                                            基準 (g)
                                        </label>
                                        <input
                                            type="number"
                                            inputMode="decimal"
                                            value={baseWeight}
                                            onChange={(e) =>
                                                setBaseWeight(
                                                    parseFloat(
                                                        e.target.value,
                                                    ) || 0,
                                                )
                                            }
                                            className="w-full px-3 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none transition-all text-sm"
                                        />
                                    </div>
                                    <div className="space-y-1.5">
                                        <label className="text-[10px] font-bold text-orange-400 uppercase tracking-wider">
                                            今回 (g)
                                        </label>
                                        <input
                                            type="number"
                                            inputMode="decimal"
                                            value={targetWeight}
                                            onChange={(e) =>
                                                setTargetWeight(
                                                    parseFloat(
                                                        e.target.value,
                                                    ) || 0,
                                                )
                                            }
                                            className="w-full px-3 py-2.5 bg-orange-50 border border-orange-200 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none font-bold text-orange-700 text-lg"
                                        />
                                    </div>
                                </div>

                                <div className="mt-4 flex items-center gap-2 text-[11px] text-slate-500 bg-slate-50 p-3 rounded-xl">
                                    <i
                                        data-lucide="info"
                                        className="w-3.5 h-3.5 text-blue-400"
                                    ></i>
                                    <span>
                                        基準の{" "}
                                        <span className="font-bold text-slate-800">
                                            {ratio.toFixed(2)} 倍
                                        </span>{" "}
                                        で計算中
                                    </span>
                                </div>
                            </div>

                            {/* Ingredients Section */}
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                                <div className="p-4 sm:p-6 border-b border-slate-100 flex justify-between items-center bg-white">
                                    <h2 className="text-base sm:text-lg font-bold text-slate-800">
                                        調味料リスト
                                    </h2>
                                    <button
                                        onClick={addRow}
                                        className="flex items-center gap-1 bg-orange-500 hover:bg-orange-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold transition-all shadow-md active:scale-95"
                                    >
                                        <i
                                            data-lucide="plus"
                                            className="w-3.5 h-3.5"
                                        ></i>
                                        追加
                                    </button>
                                </div>

                                <div className="divide-y divide-slate-100">
                                    {/* Table Header (Hidden on small mobile) */}
                                    <div className="hidden sm:grid grid-cols-12 bg-slate-50/50 text-slate-400 text-[10px] uppercase font-bold tracking-wider px-6 py-3">
                                        <div className="col-span-5">
                                            調味料名
                                        </div>
                                        <div className="col-span-3 text-right">
                                            基準分量
                                        </div>
                                        <div className="col-span-3 text-right text-orange-600 bg-orange-50/30 px-2">
                                            今回の分量
                                        </div>
                                        <div className="col-span-1"></div>
                                    </div>

                                    {ingredients.map((ing) => (
                                        <div
                                            key={ing.id}
                                            className="p-4 sm:px-6 sm:py-4 group transition-colors hover:bg-slate-50"
                                        >
                                            <div className="flex flex-col sm:grid sm:grid-cols-12 gap-3 sm:gap-4 items-center">
                                                {/* Name Input */}
                                                <div className="w-full sm:col-span-5">
                                                    <input
                                                        type="text"
                                                        value={ing.name}
                                                        onChange={(e) =>
                                                            updateIngredient(
                                                                ing.id,
                                                                "name",
                                                                e.target.value,
                                                            )
                                                        }
                                                        placeholder="例: しょうゆ"
                                                        className="w-full bg-transparent border-none focus:ring-0 text-slate-700 placeholder:text-slate-300 font-bold sm:font-medium text-base sm:text-sm p-0"
                                                    />
                                                </div>

                                                {/* Base Inputs Group */}
                                                <div className="w-full flex items-center justify-between sm:col-span-3 gap-2">
                                                    <div className="flex items-center bg-slate-100 rounded-lg px-2 py-1 w-full sm:w-auto">
                                                        <input
                                                            type="number"
                                                            step="0.1"
                                                            inputMode="decimal"
                                                            value={ing.amount}
                                                            onChange={(e) =>
                                                                updateIngredient(
                                                                    ing.id,
                                                                    "amount",
                                                                    e.target
                                                                        .value,
                                                                )
                                                            }
                                                            className="w-full text-right bg-transparent border-none focus:ring-0 outline-none font-mono text-sm"
                                                        />
                                                        <input
                                                            type="text"
                                                            value={ing.unit}
                                                            onChange={(e) =>
                                                                updateIngredient(
                                                                    ing.id,
                                                                    "unit",
                                                                    e.target
                                                                        .value,
                                                                )
                                                            }
                                                            placeholder="単位"
                                                            className="w-12 ml-1 text-xs text-slate-500 bg-transparent border-none focus:ring-0 p-0"
                                                        />
                                                    </div>
                                                    <span className="sm:hidden text-slate-300">
                                                        →
                                                    </span>
                                                </div>

                                                {/* Result Display */}
                                                <div className="w-full sm:col-span-3 flex justify-between items-center sm:justify-end bg-orange-50 sm:bg-transparent rounded-xl px-4 py-2 sm:p-0">
                                                    <span className="sm:hidden text-[10px] font-bold text-orange-400 uppercase">
                                                        今回の分量
                                                    </span>
                                                    <span className="font-bold text-orange-600 text-lg sm:text-base font-mono">
                                                        {formatNumber(
                                                            ing.amount,
                                                        )}
                                                        <span className="text-[10px] ml-1 opacity-70">
                                                            {ing.unit}
                                                        </span>
                                                    </span>
                                                </div>

                                                {/* Delete Button */}
                                                <div className="absolute right-2 top-2 sm:static sm:col-span-1 flex justify-end">
                                                    <button
                                                        onClick={() =>
                                                            removeRow(ing.id)
                                                        }
                                                        className="text-slate-300 hover:text-red-500 transition-colors p-2 sm:p-1"
                                                    >
                                                        <i
                                                            data-lucide="trash-2"
                                                            className="w-4 h-4"
                                                        ></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    ))}

                                    {ingredients.length === 0 && (
                                        <div className="px-6 py-12 text-center text-slate-400 italic text-sm">
                                            「追加」ボタンで調味料を入力してください
                                        </div>
                                    )}
                                </div>
                            </div>

                            <footer className="mt-10 mb-8 text-center text-slate-400 text-[10px]">
                                <p>© 2024 Recipe Calculator Studio</p>
                                <p className="mt-1">
                                    キッチンでの比率計算をよりスムーズに
                                </p>
                            </footer>
                        </div>
                    </div>
                );
            };

            const root = ReactDOM.createRoot(document.getElementById("root"));
            root.render(<App />);
        </script>
    </body>
</html>
